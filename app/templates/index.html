{% extends 'layout.html' %}
{% block content %}

<div class="container">	
	
	<div class="navbar">
              <div class="navbar-inner">
                <div class="container">
                  <ul class="nav">
										<li><a href="http://www.nhlchampionshipbelt.com/2014">2013-14</a></li>
										<li><a href="http://www.nhlchampionshipbelt.com/2013">2012-13</a></li>
                    <li><a href="http://www.nhlchampionshipbelt.com/2012">2011-12</a></li>
                    <li><a href="http://www.nhlchampionshipbelt.com/2011">2010-11</a></li>
                    <li><a href="http://www.nhlchampionshipbelt.com/2010">2009-10</a></li>
                    <li><a href="http://www.nhlchampionshipbelt.com/2009">2008-09</a></li>
										<li><a href="http://www.nhlchampionshipbelt.com/2008">2007-08</a></li>
                    <li><a href="http://www.nhlchampionshipbelt.com/2007">2006-07</a></li>
                    
                  </ul>
                </div>
              </div>
            </div>
	
	<div class="row">
		<div class="span4">
	    	<img src="{{ url_for('static', filename='img/NHL_ChampBelt.png') }}" alt="" title="">
	    </div>
	    <div class="span8">
				<h1>NHL Championship Belt {{ currentSeason }}</h1>
		</div>
	</div>

	<div class="row">
		<div class="span4">
			<h4>Data Sources</h4>
	            <p>
	                Idea: <a href="http://www.reddit.com/r/nba/comments/1pn9t2/can_we_keep_track_of_the_owner_of_the/">/u/hckygod91 on reddit</a><br>
	                Follow: <a href="https://twitter.com/NHLChampBelt">@NHLChampBelt</a><br>
	                Discuss:<a href="http://www.reddit.com/r/nhlchampionshipbelt">/r/nhlchampionshipbelt on reddit</a><br>
	                Scores: <a href="http://www.hockey-reference.com/">hockey-reference.com</a><br>
	                Logos: <a href="http://www.nhl.com/">nhl.com</a><br>
	                Contribute: <a href="https://github.com/cabusto/nhlchampionshipbelt">cabusto/nhlchampionshipbelt</a><br>
	                Contribute: <a href="https://github.com/bigwhoop/nbachampionshipbelt">bigwhoop/nbachampionshipbelt</a><br>
	            </p>
		</div>
		<div class="span8">
			<h4>How it works</h4>
		        <ul>
		            <li>The belt starts with last season's NHL champion.</li>
		            <li>If they lose, there is a new champion.</li>
		            <li>No playoffs, the race is over after the regular season.</li>
		        </ul>
		        <div class="row">
			        <div class="span4">
			        	<h5>NHL Champs</h5> 	
			        		<img src="{{ url_for('static', filename='img/nhl-teams/' + defendingChamp.getID() + '.png') }}" 
			        		alt="" 
			        		title="">
                <small>{{ defendingChamp.getName() }}</small>
			        </div>
			        <div class="span4">
				        {% if isOngoingSeason: %}
			                <h5>Belt Holder</h5>
			            {% else: %}
			                <h5>Belt Winner</h5>
			            {% endif %}
			        		<img src="{{ url_for('static', filename='img/nhl-teams/' + beltHolder.getID() + '.png') }}" alt="" title="">
			        		<small>{{ beltHolder.getName() }}</small>
			        </div>
		        </div>
		</div>
	</div>
</div>

<hr>

<div class="row">
	<div class="span12">
		{% if (upcomingChampGame != None): %}
            <div class="next-battle">
                <h2>Next Battle for the Belt</h2>
                <div class="matchup">
                	{{ upcomingChampGame.getAwayTeam().getID() }}
                    <img 
                        src="{{ url_for('static', filename='img/nhl-teams/' + upcomingChampGame.getAwayTeam().getID() + '.png') }}" 
                        alt="{{ upcomingChampGame.getAwayTeam().getID() }}" 
                        title="{{ upcomingChampGame.getAwayTeam().getID() }}">
                        @
                    <img 
                        src="{{ url_for('static', filename='img/nhl-teams/' + upcomingChampGame.getHomeTeam().getID() + '.png') }}" 
                        alt="{{ upcomingChampGame.getHomeTeam().getID() }}" 
                        title="{{ upcomingChampGame.getHomeTeam().getID() }}">
                    {{ upcomingChampGame.getHomeTeam().getID() }}
                </div>

                <div class="date">
                    {{ upcomingChampGame.getDate() }}
                </div>
        {% else: %}
            <p>No More Games!</p>
        {% endif %}
            </div>      
	</div>
</div>
<div class="row">
<div class="span6">
<div class="next-battle">
    {% if (upcomingChampGameIfAwayTeamWins != None): %}
        <div class="matchup">
            <img 
            src="{{ url_for('static', filename='img/nhl-teams/' + upcomingChampGameIfAwayTeamWins.getAwayTeam().getID() + '.png') }}" 
            alt="{{ upcomingChampGameIfAwayTeamWins.getAwayTeam().getID() }}" 
            title="{{ upcomingChampGameIfAwayTeamWins.getAwayTeam().getID() }}">
            @
            <img 
            src="{{ url_for('static', filename='img/nhl-teams/' + upcomingChampGameIfAwayTeamWins.getHomeTeam().getID() + '.png') }}" 
            alt="{{ upcomingChampGameIfAwayTeamWins.getHomeTeam().getID() }}" 
            title="{{ upcomingChampGameIfAwayTeamWins.getHomeTeam().getID() }}">
        </div>

        <div class="date">
            {{ upcomingChampGameIfAwayTeamWins.getDate() }}
        </div>
    {% else: %}
           <p>No More Games!</p>
    {% endif %}
               
    </div>
  
</div>
<div class="span6">
	<div class="next-battle">        
    {% if (upcomingChampGameIfHomeTeamWins != None): %}
        <div class="matchup">
            <img 
            src="{{ url_for('static', filename='img/nhl-teams/' + upcomingChampGameIfHomeTeamWins.getAwayTeam().getID() + '.png') }}" 
            alt="{{ upcomingChampGameIfHomeTeamWins.getAwayTeam().getID() }}" 
            title="{{ upcomingChampGameIfHomeTeamWins.getAwayTeam().getID() }}">
            @
            <img 
            src="{{ url_for('static', filename='img/nhl-teams/' + upcomingChampGameIfHomeTeamWins.getHomeTeam().getID() + '.png') }}" 
            alt="{{ upcomingChampGameIfHomeTeamWins.getHomeTeam().getID() }}" 
            title="{{ upcomingChampGameIfHomeTeamWins.getHomeTeam().getID() }}">
        </div>
        <div class="date">
            {{ upcomingChampGameIfHomeTeamWins.getDate() }}
        </div>
    {% else: %}
            <p>No More Games!</p>
    {% endif %}
        </div>
    </div>

</div>


<div class="row">
<div class="span6">
<h2>Game Log</h2>
  <table class="table">
    <thead>
      <tr>
        <th class="numeric">#</th>
        <th class="numeric">Date</th>
        <th class="numeric">Home Team</th>
        <th class="numeric">Score</th>
        <th class="numeric">Away Team</th>
        <th class="numeric">Winner</th>
        <th class="numeric">Streak</th>
        <th class="numeric">Wins</th>
      </tr>
    </thead>
    <tbody>
      {% set i = 1 %}
      {% for beltGame in gameLog.getGames() %}
      {% set game = beltGame.getGame() %}
      {% set newBeltHolder = beltGame.getBeltHolderAfterGame() %}
      
      <tr>
        <td class="numeric">{{ i }}</td>
        <td class="numeric">{{ game.getDate() }}</td>
        <td class="numeric">{{ game.getHomeTeam().getID() }}</td>
        <td class="numeric">{{ game.getScore() }}</td>
        <td class="numeric">{{ game.getAwayTeam().getID() }}</td>
        <td class="numeric"><img src="{{ url_for('static', filename='img/nhl-teams/' + newBeltHolder.getID() + '-med.png') }}" ></td>
        <td class="numeric">{{ beltGame.getWinStreak() }}</td>
        <td class="numeric">{{ beltGame.getAccumulatedWins() }}</td>
      </tr>
      {% set i = i + 1 %}
      {% endfor %}
    </tbody>
  </table>
  </div>
  
  <div class="span6">
    <h2>Stats</h2>
    <table class="table">
      <thead>
        <tr>
          <th rowspan="2" class="numeric">Rank</th>
          <th rowspan="2" class="numeric">Team</th>
          <th rowspan="2" class="numeric">Games</th>
          <th colspan="3" class="numeric">Wins</th>
          <th colspan="3" class="numeric">Losses</th>
          <th rowspan="2" class="numeric">Win %</th>
        </tr>
        <tr>
          <th class="numeric">Total</th>
          <th class="numeric"><small title="As Challenger">As Chall.</small></th>
          <th class="numeric"><small title="As Defender">As Def.</small></th>
          <th class="numeric">Total</th>
          <th class="numeric"><small title="As Challenger">As Chall.</small></th>
          <th class="numeric"><small title="As Defender">As Def.</small></th>
        </tr>
      </thead>
      {% set rank = 1 %}
      {% set prevWinPct = None %}
      {% set prevNumGames = None %}
      {% for ts in sortedStats: %}
      
      <tbody>
        <tr>
          <td class="numeric">
            {{ ts.team.getID() }}
            
          </td>
          <td class="numeric">
            <img 
                 src="{{ url_for('static', filename='img/nhl-teams/' + ts.team.getID() + '-med.png') }}" 
                 alt="{{ ts.team.getID() }}" 
                 title="{{ ts.team.getID() }}">
          </td>
          <td class="numeric">{{ ts.countGames() }}</td>
          <td class="numeric">{{ ts.countWins() }}</td>
          <td class="numeric">{{ ts.countWinsAsChallenger() }}</td>
          <td class="numeric">{{ ts.countWinsAsDefender() }}</td>
          <td class="numeric">{{ ts.countLosses() }}</td>
          <td class="numeric">{{ ts.countLossesAsChallenger() }}</td>
          <td class="numeric">{{ ts.countLossesAsDefender() }}</td>
          <td class="numeric">{{ ts.calcWinPercentage() }}</td>
          
          
          {% endfor %}
        </tbody>
      
    </table>
  </div>
</div>
 {% endblock %}